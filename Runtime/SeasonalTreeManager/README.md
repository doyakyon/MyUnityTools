# Seasonal Tree Manager

現実の月（Month）に合わせて、自動的に「春・夏・秋・冬」の木を切り替えて配置するUdonSharpスクリプトです。
一度に全ての木を生成せず、少しずつ生成することでワールド読み込み時の負荷（ラグ）を軽減する機能がついています。

## 特徴
- **自動季節判定**: システム時刻（PCの時計）を見て、自動で季節ごとのPrefabを選びます。
- **地形にフィット**: マーカー（配置予定地）の上空から地形判定を行い、地面の上に綺麗に配置します。
- **負荷対策**: 1フレームに生成する本数を制限し、FPS低下を防ぎます。

## ⚠️ モデル作成時の重要なお知らせ
**Blender等で木のモデルを作成する場合は、原点（Origin）の位置をオブジェクトの「真下（底面）」に設置してください。**
- 原点がモデルの中心（重心）にあると、木が地面に半分埋まって生成されてしまいます。
- Unity上で空の親オブジェクトを作り、座標調整してからPrefab化することでも対応可能です。

## 導入方法

1. **スクリプトの配置**
   - シーン上の空のGameObjectに、`SeasonalTreeManager.cs` をアタッチします。
   - `Udon Behaviour` コンポーネントが自動で追加されるので、`Program Source` にスクリプトがセットされていることを確認してください。

2. **木のPrefabを登録**
   - インスペクターの「木の種類設定」にある `Spring Prefabs` (春), `Summer Prefabs` (夏) などのリストを開き、それぞれの季節に表示させたい木のPrefabを登録します。
   - 複数登録すると、その中からランダムで選ばれます。

3. **マーカー（配置場所）の作成**
   - 木を植えたい場所に「空のGameObject」を配置します。これらが「マーカー」になります。
   - 整理のため、これらのマーカーを1つの親オブジェクト（例: `TreesLocation`）の子にまとめてください。
   - ※マーカーの高さ（Y座標）はアバウトで大丈夫です（自動で地面を探します）。

4. **インスペクター設定**
   - **Ground Layer**: 地面として判定するレイヤーを指定します（例: `Default` や `Environment`）。
   - **Markers Parent**: 手順3で作成した「マーカーをまとめた親オブジェクト」をここにドラッグ＆ドロップします。

## 設定項目（詳細）

| 項目名 | 説明 |
| --- | --- |
| **Ground Layer** | 地面判定を行うレイヤーです。木が空中に浮く場合はここを確認してください。 |
| **Markers Parent** | 木を植える場所（空のオブジェクト）をまとめた親Transformを指定します。 |
| **Trees Per Frame** | 1フレーム（約0.01秒）あたりに生成する木の数です。数値を下げると読み込みが軽くなりますが、全ての木が生え終わるまで時間がかかります。（推奨: 30～50） |
| **Sink Depth** | 地面にめり込ませる深さです。木の根元が浮いて見える場合は `0.1` ～ `0.3` 程度に設定してください。 |
| **Debug Month** | `0` の場合は現実の時刻を使います。`1`～`12` を入力すると、強制的にその月の季節をテストできます。 |

## 季節の判定ロジック
- **春**: 3月, 4月, 5月
- **夏**: 6月, 7月, 8月
- **秋**: 9月, 10月, 11月
- **冬**: 12月, 1月, 2月

## 注意事項
- このスクリプトは `VRChat World SDK` および `UdonSharp` が必要です。
- 地形のコライダーがない場所（穴が開いている場所など）では、Raycastがヒットせず木が生成されない場合があります。